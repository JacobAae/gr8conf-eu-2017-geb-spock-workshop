<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="author" content="Jacob Aae Mikkelsen" /><title>Browser Based Testing with Geb and Spock</title><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><link href="reveal.js/css/reveal.css" rel="stylesheet" /><link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" /><style>/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}</style><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet" /><script>document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script><style>

    #presentation-logo img {
		position: absolute;
		width: 8%;
		top: 10px;
		right: 10px;
	}

	#conference-logo img {
		position: absolute;
		width: 7%;
		bottom: 10px;
		left: 10px;
	}



	.reveal section img {
	border: none;
}

.admonitionblock {
		padding-top: 20px;
		padding-bottom: 20px;
}

div.tip {
	min-height: 20px;
	padding: 19px;
	margin-bottom: 20px;
	background-color: #aaffaa;
/*	background-color: #f5f5f5; */
	border-color: rgba(0, 0, 0, 0.25);
	border: 1px solid rgba(0, 0, 0, 0.25);
	-webkit-border-radius: 4px;
	-moz-border-radius: 4px;
	border-radius: 4px;
	-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
	-moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
	box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}

.admonitionblock > table td.icon {
	width: 1em;
	padding: 10px;
}

.admonitionblock > table td.icon .fa {
	font-size: 1.5em;
}

.admonitionblock > table td.icon .icon-tip:before {
	text-shadow: 0 0 20px white, 1px 1px 2px rgba(155, 155, 0, 0.8);
}

.admonitionblock > table td.content {
	font-family: 'Noticia Text', italic;
	font-size: 95%;
	font-style: italic;
	border: 0;
	padding: 15px;
}


div.hdlist td.hdlist1 {
	font-weight: bold;
	padding-right: 1em;
}

	.reveal section span.inline-image img {
		margin: -15px 0px;
		background: rgba(255, 255, 255, 0.12);
		border: 0px solid;
		box-shadow: 0 0 0px ;
	}



	/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}


</style>



<!--
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
/*
	jQuery( document ).ready(function( $ ) {
		jQuery('i.fa-exclamation-circle').addClass('fa-wheelchair').removeClass('a-exclamation-circle');
	});
*/
</script>
--></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title"><h1>Browser Based Testing with Geb and Spock</h1><p class="author"><small>Jacob Aae Mikkelsen</small></p></section><section><section id="agenda"><h2>Agenda</h2><div class="ulist"><ul><li><p>Short intro</p></li><li><p>Guided work</p></li></ul></div><aside class="notes"><div class="paragraph"><p>You will be doing the work :)</p></div></aside></section><section id="jacob-aae-mikkelsen"><h2>Jacob Aae Mikkelsen</h2><div class="ulist"><ul><li><p>Senior Software Architect at Cardlay A/S</p></li><li><p>GR8Conf EU - Organizing Team Member</p></li><li><p>External Associate Professor - University of Southern Denmark</p></li><li><p>Groovy Ecosystem Nerd</p></li><li><p><span class="image inline-image"><img src="./images/twitter.png" alt="Twitter" width="35" height="35" /></span> @JacobAae</p></li><li><p>Blogs <a href="http://grydeske.net/news">The Grails Diary</a></p></li></ul></div></section></section>
<section><section id="spock"><h2>Spock</h2></section><section id="intro"><h2>Intro</h2><div class="paragraph"><p>Spock is:</p></div>
<div class="ulist step"><ul><li class="fragment"><p>Testing Framework for Java and Groovy (and other JVM languages)</p></li><li class="fragment"><p>Based on Groovy</p></li><li class="fragment"><p>Fully compatible with JUnit</p></li></ul></div></section><section id="intro-2"><h2>Intro</h2><div class="paragraph"><p>and can:</p></div>
<div class="ulist step"><ul><li class="fragment"><p>Reduce the lines of test code</p></li><li class="fragment"><p>Make tests more readable</p></li><li class="fragment"><p>Turn tests into specifications</p></li></ul></div></section><section id="funny-trivia"><h2>Funny trivia</h2><div class="ulist step"><ul><li class="fragment"><p>Created by Peter Niederwieser</p></li><li class="fragment"><p>Does not have a logo</p></li><li class="fragment"><p>Combination of Specification and Mock</p></li><li class="fragment"><p>Released in 1.0 (finally) when Leonard Nimoy died</p></li><li class="fragment"><p>Current latest: 1.1</p></li></ul></div></section></section>
<section><section id="dependencies"><h2>Dependencies</h2></section><section id="mandatory-dependencies"><h2>Mandatory Dependencies</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.codehaus.groovy:groovy-all:2.4.11</span><span class="delimiter">&quot;</span></span>
testCompile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.spockframework:spock-core:1.1-groovy-2.4</span><span class="delimiter">&quot;</span></span></code></pre></div></div>
<div class="paragraph"><p>And the Groovy Plugin in Gradle</p></div></section><section id="optional-dependencies"><h2>Optional Dependencies</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="comment">// only necessary if Hamcrest matchers are used</span>
testCompile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.hamcrest:hamcrest-core:1.3</span><span class="delimiter">&quot;</span></span>

<span class="comment">// allows mocking of classes (in addition to interfaces)</span>
testRuntime <span class="string"><span class="delimiter">&quot;</span><span class="content">cglib:cglib-nodep:3.1</span><span class="delimiter">&quot;</span></span>

<span class="comment">// allows mocking of classes without default constructor (together with CGLIB)</span>
testRuntime <span class="string"><span class="delimiter">&quot;</span><span class="content">org.objenesis:objenesis:2.1</span><span class="delimiter">&quot;</span></span></code></pre></div></div></section></section>
<section><section id="spock-basics"><h2>Spock Basics</h2></section><section id="spec"><h2>Spec</h2><div class="ulist"><ul><li><p>Groovy Class extending <code>spock.lang.Specification</code></p></li></ul></div></section><section id="basic-spock-spec"><h2>Basic Spock Spec</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">class</span> <span class="class">BasicSpec</span> <span class="directive">extends</span> spock.lang.Specification {

    <span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Very small Example of a spock test</span><span class="delimiter">&quot;</span></span>() {
        <span class="key">expect</span>:
        <span class="integer">21</span> * <span class="integer">2</span> == <span class="integer">42</span>
    }
}</code></pre></div></div></section><section id="blocks"><h2>Blocks</h2><div class="paragraph"><p>Assert</p></div>
<div class="ulist"><ul><li><p><strong>expect</strong></p></li></ul></div>
<div class="paragraph"><p>Setup Blocks</p></div>
<div class="ulist"><ul><li><p><strong>setup</strong>, <strong>given</strong></p></li></ul></div>
<div class="paragraph"><p>Stimulus - Response blocks</p></div>
<div class="ulist"><ul><li><p><strong>when</strong>, <strong>then</strong></p></li></ul></div></section><section id="blocks-2"><h2>Blocks</h2><div class="paragraph"><p>More:</p></div>
<div class="ulist"><ul><li><p><strong>cleanup</strong></p></li><li><p><strong>and</strong></p></li><li><p><strong>where</strong></p></li></ul></div>
<div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content"><em>Rule of thumb:</em> Use <strong>when-then</strong> when you have side-effects, and <strong>expect</strong> when you have purely functional</td></tr></table></div></section><section id="lifecycle"><h2>Lifecycle</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">def</span> <span class="function">setupSpec</span>() {
    <span class="comment">// Run once per class</span>
}
<span class="keyword">def</span> <span class="function">setup</span>() {
    <span class="comment">// Run once per method</span>
}
<span class="keyword">def</span> <span class="function">cleanup</span>() {
    <span class="comment">// Run once per method</span>
}
<span class="keyword">def</span> <span class="function">cleanupSpec</span>() {
    <span class="comment">// Run once per class</span>
}</code></pre></div></div></section><section id="basic-spock-example"><h2>Basic Spock Example</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Spock basic example</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">setup</span>:
    <span class="keyword">def</span> conferences = [<span class="string"><span class="delimiter">'</span><span class="content">GR8Conf EU</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">GR8Conf US</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">GR8Conf IN</span><span class="delimiter">'</span></span>]

    <span class="key">expect</span>:
    conferences*.charAt(<span class="integer">0</span>) == [<span class="string"><span class="delimiter">'</span><span class="content">G</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">G</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">G</span><span class="delimiter">'</span></span>]
}</code></pre></div></div></section><section id="classical-unit-testing"><h2>Classical Unit Testing</h2><div class="ulist"><ul><li><p>Arrange</p></li><li><p>Act</p></li><li><p>Assert</p></li></ul></div>
<div class="ulist step"><ul><li class="fragment"><p>In Spock: <strong>Given-When-Then</strong></p></li></ul></div></section><section id="given-when-then"><h2>Given When Then</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Demo of given when then</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">given</span>:
    <span class="keyword">def</span> conferences = [<span class="string"><span class="delimiter">'</span><span class="content">GR8Conf EU</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">GR8Conf US</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">GR8Conf IN</span><span class="delimiter">'</span></span>]

    <span class="key">when</span>:
    conferences &lt;&lt; <span class="string"><span class="delimiter">'</span><span class="content">Greach</span><span class="delimiter">'</span></span>

    <span class="key">then</span>:
    conferences.size() == <span class="integer">4</span>
}</code></pre></div></div></section><section id="power-assert-example"><h2>Power Assert Example</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Power assert failure example</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">expect</span>:
    [<span class="string"><span class="delimiter">'</span><span class="content">GR8Conf</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">EU</span><span class="delimiter">'</span></span>].join(<span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>).length() == <span class="integer">3</span>
}</code></pre></div></div></section><section id="power-assert-example-2"><h2>Power Assert Example</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>Condition not satisfied:

['GR8Conf','EU'].join(' ').length() == 3
                 |         |        |
                 |         10       false
                 GR8Conf EU</code></pre></div></div></section><section id="check-multiple-before-failing"><h2>Check Multiple Before Failing</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="annotation">@FailsWith</span>(<span class="exception">Exception</span>)
<span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Check multiple conditions and fail after all are checked</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>:
    <span class="keyword">def</span> list = <span class="integer">1</span>..<span class="integer">4</span>

    <span class="key">then</span>:
    verifyAll {
        list.last() == <span class="integer">1</span>
        list.first() == <span class="integer">4</span>
    }
}</code></pre></div></div></section><section id="check-multiple-before-failing-2"><h2>Check Multiple Before Failing</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>Condition not satisfied:
list.last() == 1
|    |      |
|    4      false
[1, 2, 3, 4]

Condition not satisfied:
list.first() == 4
|    |       |
|    1       false
[1, 2, 3, 4]</code></pre></div></div></section><section id="old"><h2>Old</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Verify based on previous state</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">given</span>:
    <span class="keyword">def</span> primes = [<span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">5</span>, <span class="integer">7</span>, <span class="integer">11</span>, <span class="integer">13</span>]

    <span class="key">when</span>:
    primes &lt;&lt; <span class="integer">17</span>

    <span class="key">then</span>:
    primes.size() == old(primes.size()) + <span class="integer">1</span>

}</code></pre></div></div></section><section id="shared-resources"><h2>Shared Resources</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="annotation">@Shared</span>
<span class="keyword">def</span> expensiveResource

<span class="keyword">def</span> <span class="function">setupSpec</span>() {
    expensiveResource = <span class="keyword">new</span> JsonSlurper().parse(
            <span class="string"><span class="delimiter">'</span><span class="content">http://tambal.azurewebsites.net/joke/1</span><span class="delimiter">'</span></span>.toURL())
}

<span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Verify Joke 1</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">expect</span>:
    expensiveResource.joke.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">I'm reading a book about anti-gravity.</span><span class="delimiter">&quot;</span></span>)
}
<span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Verify Joke 2</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">expect</span>:
    expensiveResource.joke.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">It's impossible to put down.</span><span class="delimiter">&quot;</span></span>)
}</code></pre></div></div></section><section id="async-and-eventual-conditions"><h2>Async and Eventual Conditions</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="key">given</span>:
<span class="keyword">def</span> conditions = <span class="keyword">new</span> PollingConditions(<span class="key">timeout</span>: <span class="integer">10</span>,
        <span class="key">initialDelay</span>: <span class="float">1.5</span>, <span class="key">factor</span>: <span class="float">1.25</span>)
<span class="keyword">def</span> machine = <span class="keyword">new</span> Machine()

<span class="key">when</span>:
machine.start()

<span class="key">then</span>:
conditions.eventually {
    <span class="keyword">assert</span> machine.temperature &gt;= <span class="integer">100</span>
    <span class="keyword">assert</span> machine.efficiency &gt;= <span class="float">0.9</span>
}</code></pre></div></div></section></section>
<section><section id="data-driven"><h2>Data Driven</h2></section><section id="data-driven-2"><h2>Data Driven</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">is square</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>:
    <span class="keyword">def</span> sqrt = <span class="predefined-type">Math</span>.sqrt(number)

    <span class="key">then</span>:
    sqrt * sqrt == number

    <span class="key">where</span>:
    number &lt;&lt; [ <span class="integer">5</span>, <span class="integer">64</span> , <span class="integer">100100</span> ]
}</code></pre></div></div></section><section id="data-driven-3"><h2>Data Driven</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">squareroot</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">expect</span>:
    <span class="predefined-type">Math</span>.sqrt(number) == sqrt

    <span class="key">where</span>:
    number      || sqrt
    <span class="integer">4</span>           || <span class="integer">2</span>
    <span class="integer">9</span>           || <span class="integer">3</span>
    <span class="integer">16</span>          || <span class="integer">4</span>
}</code></pre></div></div></section><section id="unroll"><h2>Unroll</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="annotation">@Unroll</span>
<span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Square of #number is #square</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">expect</span>:
    number * number == square

    <span class="key">where</span>:
    number      || square
    <span class="integer">1</span>           || <span class="integer">1</span>
    <span class="integer">2</span>           || <span class="integer">4</span>
    <span class="integer">10</span>          || <span class="integer">100</span>
}</code></pre></div></div></section><section id="unroll-2"><h2>Unroll</h2><div class="imageblock" style=""><img src="./images/unroll.png" alt="unroll" /></div></section></section>
<section><section id="interaction-based-testing"><h2>Interaction Based Testing</h2></section><section id="mocking"><h2>Mocking</h2><div class="paragraph"><p>Mocking is the act of describing (mandatory) interactions between the object under specification and its collaborators.</p></div></section><section id="mocking-2"><h2>Mocking</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">class</span> <span class="class">SignupService</span> {

    PaymentService paymentService = <span class="keyword">new</span> PaymentService()
    <span class="predefined-type">List</span> signedUp = <span class="type">[]</span>

    <span class="directive">public</span> signup(<span class="predefined-type">String</span> username, <span class="predefined-type">String</span> accountNumber, <span class="predefined-type">BigDecimal</span> amount) {
        <span class="keyword">if</span>( paymentService.pay(accountNumber, amount) &gt;= amount ) {
            signedUp &lt;&lt; username
        } <span class="keyword">else</span> {
            <span class="keyword">throw</span> <span class="keyword">new</span> NoMoneyException(<span class="string"><span class="delimiter">'</span><span class="content">Sorry you have not paid</span><span class="delimiter">'</span></span>)
        }
    }
    <span class="directive">public</span> <span class="predefined-type">List</span> getSignedUpUsers() {
        signedUp.clone()
    }
}</code></pre></div></div></section><section id="mocking-3"><h2>Mocking</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Payment service must be called</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">setup</span>:
    SignupService signupService = <span class="keyword">new</span> SignupService()
    PaymentService paymentService = Mock(PaymentService)
    signupService.paymentService = paymentService

    <span class="key">when</span>:
    signupService.signup(<span class="string"><span class="delimiter">'</span><span class="content">Jacob</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>, <span class="integer">100</span>)

    <span class="key">then</span>:
    <span class="integer">1</span> * paymentService.pay(<span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>, <span class="integer">100</span>)
    thrown(NoMoneyException)
}</code></pre></div></div></section><section id="mocking-4"><h2>Mocking</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code>1 * paymentService.pay('42',100)
|   |              |    |
|   |              |    argument constraint
|   |             method constraint
|   target constraint
cardinality</code></pre></div></div></section><section id="mocking-cardinality"><h2>Mocking - Cardinality</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="integer">1</span> * paymentService.pay(<span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>,<span class="integer">100</span>)        <span class="comment">// Exactly once</span>
<span class="integer">0</span> * paymentService.pay(<span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>,<span class="integer">100</span>)        <span class="comment">// Zero times</span>
(<span class="integer">1</span>..<span class="integer">4</span>) * paymentService.pay(<span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>,<span class="integer">100</span>)   <span class="comment">// 1 to 4 times</span>
(<span class="integer">1</span>.._) * paymentService.pay(<span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>,<span class="integer">100</span>)   <span class="comment">// At least once</span></code></pre></div></div></section><section id="mocking-argument"><h2>Mocking - Argument</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="comment">// Parameter values must match</span>
<span class="integer">1</span> * paymentService.pay(<span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>,<span class="integer">100</span>)

<span class="comment">// Any parameter list</span>
<span class="integer">1</span> * paymentService.pay(*_)

<span class="comment">// Constraints using closures</span>
<span class="integer">1</span> * paymentService.pay({ <span class="local-variable">it</span>.length() &gt; <span class="integer">1</span>},{<span class="local-variable">it</span> &gt; <span class="integer">200</span>})</code></pre></div></div></section><section id="mock-checking-order"><h2>Mock Checking - Order</h2><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">If the order of execution of your mocked methods are important, you can force check the order by separating them with the <strong>and:</strong> block</td></tr></table></div></section><section id="stubbing"><h2>Stubbing</h2><div class="paragraph"><p>Stubbing is the act of making collaborators respond to method calls in a certain way.</p></div>
<div class="paragraph"><p>When stubbing a method, you don’t care if and how many times the method is going to be called;
you just want it to return some value, or perform some side effect, whenever it gets called.</p></div></section><section id="stubbing-2"><h2>Stubbing</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Payment not accepted throws exception</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">setup</span>:
    SignupService signupService = <span class="keyword">new</span> SignupService()
    PaymentService paymentService = Mock(PaymentService)
    signupService.paymentService = paymentService

    <span class="key">and</span>:
    paymentService.pay(_,_) &gt;&gt; <span class="integer">0</span>

    <span class="key">when</span>:
    signupService.signup(<span class="string"><span class="delimiter">'</span><span class="content">Jacob</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>, <span class="integer">100</span>)

    <span class="key">then</span>:
    thrown(NoMoneyException)
}</code></pre></div></div></section><section id="stubbing-3"><h2>Stubbing</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Payment accepted puts user on list</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">setup</span>:
    SignupService signupService = <span class="keyword">new</span> SignupService()
    PaymentService paymentService = Mock(PaymentService)
    signupService.paymentService = paymentService

    <span class="key">and</span>:
    paymentService.pay(_,_) &gt;&gt; <span class="integer">120</span>

    <span class="key">when</span>:
    signupService.signup(<span class="string"><span class="delimiter">'</span><span class="content">Jacob</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>, <span class="integer">100</span>)

    <span class="key">then</span>:
    <span class="string"><span class="delimiter">'</span><span class="content">Jacob</span><span class="delimiter">'</span></span> <span class="keyword">in</span> signupService.signedUpUsers
}</code></pre></div></div></section><section id="stubbing-multiple-return-values"><h2>Stubbing - Multiple return values</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Multiple payments with different value</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">setup</span>:
    SignupService signupService = <span class="keyword">new</span> SignupService()
    PaymentService paymentService = Mock(PaymentService)
    signupService.paymentService = paymentService
    <span class="key">and</span>:
    paymentService.pay(_,_) &gt;&gt;&gt; [<span class="integer">100</span>, <span class="integer">80</span>, <span class="integer">60</span>]

    <span class="key">when</span>:
    signupService.signup(<span class="string"><span class="delimiter">'</span><span class="content">Person 1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>, <span class="integer">70</span>)
    signupService.signup(<span class="string"><span class="delimiter">'</span><span class="content">Person 2</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>, <span class="integer">70</span>)
    signupService.signup(<span class="string"><span class="delimiter">'</span><span class="content">Person 3</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">42</span><span class="delimiter">'</span></span>, <span class="integer">70</span>)

    <span class="key">then</span>:
    signupService.signedUpUsers == [<span class="string"><span class="delimiter">'</span><span class="content">Person 1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Person 2</span><span class="delimiter">'</span></span>]
    thrown(NoMoneyException)
}</code></pre></div></div></section></section>
<section><section id="extensions"><h2>Extensions</h2></section><section id="built-in-extensions"><h2>Built-In Extensions</h2><div class="paragraph"><p>Most of Spock’s built-in extensions are annotation-driven.</p></div>
<div class="ulist"><ul><li><p><code>@Ignore</code></p></li><li><p><code>@IgnoreRest</code></p></li><li><p><code>@IgnoreIf</code></p></li><li><p><code>@FailsWith</code></p></li><li><p><code>@Stepwise</code></p></li></ul></div></section><section id="extension-timeout"><h2>Extension: @Timeout</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="annotation">@Timeout</span>(<span class="integer">5</span>)
<span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">I fail if I run for more than five seconds</span><span class="delimiter">&quot;</span></span>() { ... }

<span class="annotation">@Timeout</span>(value = <span class="integer">100</span>, unit = <span class="predefined-type">TimeUnit</span>.MILLISECONDS)
<span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">I better be quick</span><span class="delimiter">&quot;</span></span> { ... }</code></pre></div></div></section><section id="extension-confinemetaclasschanges"><h2>Extension: ConfineMetaClassChanges</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="annotation">@Stepwise</span>
<span class="type">class</span> <span class="class">FooSpec</span> <span class="directive">extends</span> Specification {

  <span class="annotation">@ConfineMetaClassChanges</span>([<span class="predefined-type">String</span>])
  <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">I run first</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>:
    <span class="predefined-type">String</span>.metaClass.someMethod = { delegate }
    <span class="key">then</span>:
    <span class="predefined-type">String</span>.metaClass.hasMetaMethod(<span class="string"><span class="delimiter">'</span><span class="content">someMethod</span><span class="delimiter">'</span></span>)
  }
  <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">I run second</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>:
    <span class="string"><span class="delimiter">&quot;</span><span class="content">Foo</span><span class="delimiter">&quot;</span></span>.someMethod()
    <span class="key">then</span>:
    thrown(MissingMethodException)
  }
}</code></pre></div></div></section><section id="specifications-as-documentation"><h2>Specifications as Documentation</h2><div class="paragraph"><p>Use dependency:</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">testCompile( <span class="string"><span class="delimiter">'</span><span class="content">com.athaydes:spock-reports:1.3.1</span><span class="delimiter">'</span></span> ) {
    transitive = <span class="predefined-constant">false</span> <span class="comment">// this avoids affecting your version of Groovy/Spock</span>
}

<span class="comment">// if you don't already have slf4j-api and an implementation of it in the classpath</span>
testCompile <span class="string"><span class="delimiter">'</span><span class="content">org.slf4j:slf4j-api:1.7.13</span><span class="delimiter">'</span></span>
testCompile <span class="string"><span class="delimiter">'</span><span class="content">org.slf4j:slf4j-simple:1.7.13</span><span class="delimiter">'</span></span></code></pre></div></div></section><section id="specifications-as-documentation-2"><h2>Specifications as Documentation</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">specifications as documentation</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">given</span>: <span class="string"><span class="delimiter">'</span><span class="content">New PaymentService is created</span><span class="delimiter">'</span></span>
    PaymentService paymentService = <span class="keyword">new</span> PaymentService()

    <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Empty account input is handed to the service</span><span class="delimiter">'</span></span>
    paymentService.pay(account,<span class="integer">100</span>)

    <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">Assertion fails with exception</span><span class="delimiter">'</span></span>
    thrown(PowerAssertionError)

    <span class="key">where</span>: <span class="string"><span class="delimiter">'</span><span class="content">Invalid values</span><span class="delimiter">'</span></span>
    account &lt;&lt; [<span class="predefined-constant">null</span>, <span class="string"><span class="delimiter">'</span><span class="content">-</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content"> </span><span class="delimiter">'</span></span>]
}</code></pre></div></div></section><section id="specifications-as-documentation-3"><h2>Specifications as Documentation</h2><div class="imageblock" style=""><img src="./images/reports.png" alt="reports" /></div></section></section>
<section><section id="functional-testing"><h2>Functional testing</h2></section><section id="functional-testing-2"><h2>Functional testing</h2><div class="ulist"><ul><li><p>Ignores the specifics of the underlying software component under test.</p><div class="ulist"><ul><li><p>Whitebox / Greybox</p></li></ul></div></li><li><p>Merely asserts that providing certain input results in certain output.</p></li><li><p><strong>Web-application:</strong> Programmatically controlling a web browser to simulate the actions of a user on a web page.</p></li></ul></div></section></section>
<section><section><div class="imageblock" style=""><img src="./images/geb.png" alt="geb" width="80%" /></div></section><section id="geb-history"><h2>Geb history</h2><div class="ulist"><ul><li><p>Started in November 2009</p></li><li><p>Created by Luke Daley</p></li><li><p>Current project lead Marcin Erdman</p></li></ul></div></section><section id="geb-implementation"><h2>Geb Implementation</h2><div class="ulist"><ul><li><p>Build on top of the WebDriver browser automation library</p><div class="ulist"><ul><li><p>successor to the Selenium Remote Control (RC) testing framework.</p></li><li><p>Selenium RC &#8594; JavaScript to interact</p></li><li><p>WebDriver &#8594; native browser drivers</p></li></ul></div></li><li><p>Use JUnit or Spock</p></li></ul></div>
<aside class="notes">WebDriver &#8594; Known as "Selenium 2"<br />
Sponsored by Google<br />
Becomming W3C standard<br />
<a href="https://w3c.github.io/webdriver/webdriver-spec.html" class="bare">https://w3c.github.io/webdriver/webdriver-spec.html</a></aside></section><section id="webdriver"><h2>WebDriver</h2><div class="ulist"><ul><li><p>Very active development</p></li><li><p>Stable API and feature set</p></li><li><p>Verbose</p></li><li><p>Low level</p></li><li><p>Not a complete solution</p></li></ul></div>
<aside class="notes">Geb aims to embrace the pros and solve the cons by building on top.<br />
Only real player in browser automation</aside></section><section id="why-geb"><h2>Why Geb</h2><div class="ulist"><ul><li><p>jQuery like selector syntax</p></li><li><p>Power of WebDriver (Easier api)</p></li><li><p>Robustness of Page Object modeling</p></li><li><p>Expressiveness of the Groovy language</p></li><li><p>Integrates well with build systems (Gradle/Maven)</p></li><li><p>Excellent user manual/documentation</p></li></ul></div></section><section id="stack"><h2>Stack</h2><div class="imageblock" style=""><img src="./images/stack.png" alt="stack" /></div>
<aside class="notes">Application under test</aside>
<aside class="notes">Not only Browser based</aside></section></section>
<section><section id="using-geb"><h2>Using Geb</h2></section><section id="navigator"><h2>Navigator</h2><div class="paragraph"><p>The <code>$()</code> method returns a Navigator object</p></div>
<div class="paragraph"><p>General format - Jquery like selecter syntax</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="error">$</span>( &lt;css selector&gt;, &lt;index/range&gt;, &lt;attribute/text matchers&gt; )</code></pre></div></div></section><section id="geb-selectors-1"><h2>Geb Selectors (1)</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="comment">// match all 'p' elements on page</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>)

<span class="comment">// match the first 'p' element on the page</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>, <span class="integer">0</span>)

<span class="comment">// All 'div' elements with a title value 'section'</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div</span><span class="delimiter">&quot;</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">section</span><span class="delimiter">&quot;</span></span>)

<span class="comment">// match the first 'div' element text 'section'</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div</span><span class="delimiter">&quot;</span></span>, <span class="integer">0</span>, <span class="key">text</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">section</span><span class="delimiter">&quot;</span></span>)

<span class="comment">// match the first 'div' element with the class 'main'</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div.main</span><span class="delimiter">&quot;</span></span>, <span class="integer">0</span>)</code></pre></div></div></section><section id="geb-selectors-2"><h2>Geb Selectors (2)</h2><div class="paragraph"><p>Text attribute supports regex</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="comment">// Any div with the text starting wih GR8</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div</span><span class="delimiter">&quot;</span></span>, <span class="key">text</span>: ~<span class="regexp"><span class="delimiter">/</span><span class="content">GR8.+</span><span class="delimiter">/</span></span>)
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>, <span class="key">text</span>: startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">GR8</span><span class="delimiter">&quot;</span></span>))

<span class="comment">// And other handy predicates</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div</span><span class="delimiter">&quot;</span></span>, <span class="type">class</span>: <span class="class">contains</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">ui-</span><span class="delimiter">&quot;</span></span>))</code></pre></div></div></section><section id="geb-selectors-3"><h2>Geb Selectors (3)</h2><div class="paragraph"><p>Selecting returns <code>Navigator</code> objects</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="comment">// The parent of the first div</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div</span><span class="delimiter">&quot;</span></span>, <span class="integer">0</span>).parent()

<span class="comment">// All tables with a cellspacing</span>
<span class="comment">// attribute value of 0 that are nested in a paragraph</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>).find(<span class="string"><span class="delimiter">&quot;</span><span class="content">table</span><span class="delimiter">&quot;</span></span>, <span class="key">cellspacing</span>: <span class="string"><span class="delimiter">'</span><span class="content">0</span><span class="delimiter">'</span></span>)</code></pre></div></div>
<aside class="notes">previous()<br />
next()<br />
parent()<br />
siblings()<br />
children()</aside></section><section id="css-support"><h2>CSS Support</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">table tr:nth-child(2n+1) td</span><span class="delimiter">&quot;</span></span>)</code></pre></div></div>
<aside class="notes">Full CSS3 if the target browser supports it.+
CSS lookup is efficient</aside></section><section id="retriving-information"><h2>Retriving Information</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="html language-html"><span class="tag">&lt;p</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sample</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">class-a class-b</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">title</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sample p element</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
Sample text
<span class="tag">&lt;/p&gt;</span></code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>).text() == <span class="string"><span class="delimiter">&quot;</span><span class="content">Sample text</span><span class="delimiter">&quot;</span></span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#sample</span><span class="delimiter">&quot;</span></span>).tag() == <span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>).@title == <span class="string"><span class="delimiter">&quot;</span><span class="content">Sample p element</span><span class="delimiter">&quot;</span></span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>).classes() == [<span class="string"><span class="delimiter">&quot;</span><span class="content">class-a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">class-b</span><span class="delimiter">&quot;</span></span>]</code></pre></div></div></section><section id="interaction-with-content"><h2>Interaction with content</h2><div class="ulist"><ul><li><p><code>click()</code></p></li><li><p><code>isDisplayed()</code></p></li><li><p><code>withConfirm{}</code></p></li><li><p><code>withAlert{}</code></p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">a.btn</span><span class="delimiter">&quot;</span></span>).click()
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div</span><span class="delimiter">&quot;</span></span>).isDisplayed()

withConfirm {
    <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">button.delete</span><span class="delimiter">&quot;</span></span>).click()
}</code></pre></div></div></section><section id="sending-input"><h2>Sending input</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">import</span> <span class="include">org.openqa.selenium.Keys</span>

<span class="comment">// Shorthand for sendKeys() method of WebDriver.</span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div</span><span class="delimiter">&quot;</span></span>) &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">abc</span><span class="delimiter">&quot;</span></span>

<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">input</span><span class="delimiter">&quot;</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>) &lt;&lt; Keys.chord(Keys.CONTROL, <span class="string"><span class="delimiter">&quot;</span><span class="content">c</span><span class="delimiter">&quot;</span></span>)</code></pre></div></div></section><section id="interaction"><h2>Interaction</h2><div class="paragraph"><p>Using <code>Actions</code> API from WebDriver is possible.</p></div>
<div class="paragraph"><p>But Geb provides the <code>interact</code> closure</p></div></section><section id="control-clicking"><h2>Control-clicking</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">import</span> <span class="include">org.openqa.selenium.Keys</span>

interact {
    keyDown Keys.CTRL
    click <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">a.myLink</span><span class="delimiter">&quot;</span></span>)
    keyUp Keys.CTRL
}</code></pre></div></div></section><section id="more-interaction-with-forms"><h2>More interaction with forms</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="html language-html"><span class="tag">&lt;form&gt;</span>
    <span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">geb</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Functional</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/form&gt;</span></code></pre></div></div>
<div class="paragraph"><p>The value can be read and written via property notation…</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form</span><span class="delimiter">&quot;</span></span>).geb == <span class="string"><span class="delimiter">&quot;</span><span class="content">Functional</span><span class="delimiter">&quot;</span></span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form</span><span class="delimiter">&quot;</span></span>).geb = <span class="string"><span class="delimiter">&quot;</span><span class="content">Testing</span><span class="delimiter">&quot;</span></span></code></pre></div></div>
<div class="paragraph"><p>These are literally shortcuts for…</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form</span><span class="delimiter">&quot;</span></span>).find(<span class="string"><span class="delimiter">&quot;</span><span class="content">input</span><span class="delimiter">&quot;</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">geb</span><span class="delimiter">&quot;</span></span>).value() == <span class="string"><span class="delimiter">&quot;</span><span class="content">Functional</span><span class="delimiter">&quot;</span></span>
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form</span><span class="delimiter">&quot;</span></span>).find(<span class="string"><span class="delimiter">&quot;</span><span class="content">input</span><span class="delimiter">&quot;</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">geb</span><span class="delimiter">&quot;</span></span>).value(<span class="string"><span class="delimiter">&quot;</span><span class="content">Testing</span><span class="delimiter">&quot;</span></span>)</code></pre></div></div></section><section id="variables-available"><h2>Variables Available</h2><div class="ulist"><ul><li><p><code>title</code></p></li><li><p><code>browser</code></p></li><li><p><code>currentUrl</code></p></li><li><p><code>currentWindow</code></p></li></ul></div></section><section id="more-possibilities"><h2>More possibilities</h2><div class="ulist"><ul><li><p>Uploading files</p></li><li><p>Downloading files</p></li><li><p>Interacting with javascript</p><div class="ulist"><ul><li><p>js object (Example later)</p></li></ul></div></li></ul></div></section></section>
<section><section id="standalone-geb-script"><h2>Standalone Geb Script</h2></section><section id="geb-standalone-example"><h2>Geb Standalone example</h2><div class="paragraph"><p>Lets try to automate:</p></div>
<div class="ulist"><ul><li><p>Searching for <code>Greach Conference</code></p></li><li><p>Click the first link</p></li><li><p>Hopefully end up on the right homepage</p></li></ul></div></section><section id="geb-standalone-example-2"><h2>Geb Standalone example</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">go <span class="string"><span class="delimiter">&quot;</span><span class="content">http://duckduckgo.com</span><span class="delimiter">&quot;</span></span>

<span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">input</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">q</span><span class="delimiter">'</span></span>).value(<span class="string"><span class="delimiter">&quot;</span><span class="content">Greach Conference</span><span class="delimiter">&quot;</span></span>)
<span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">input</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">q</span><span class="delimiter">'</span></span>) &lt;&lt; Keys.ENTER

waitFor(<span class="integer">10</span>, <span class="integer">1</span>) { <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#links</span><span class="delimiter">&quot;</span></span>).displayed }
   sleep(<span class="integer">3000</span>) <span class="comment">// For demo reasons</span>

<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">h2.result__title</span><span class="delimiter">&quot;</span></span>).first().click()

waitFor { title.startsWith <span class="string"><span class="delimiter">&quot;</span><span class="content">Greach</span><span class="delimiter">&quot;</span></span> }</code></pre></div></div>
<aside class="notes">LIVE DEMO: standalon.groovy<br />
Run from</aside></section></section>
<section><section id="structuring-geb-tests"><h2>Structuring Geb Tests</h2></section><section id="scenario"><h2>Scenario</h2><div class="paragraph"><p>Lets test a small todo application</p></div>
<div class="paragraph"><p><strong>Lets test the following</strong></p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Goto list of todos</p></li><li><p>Create new item</p></li><li><p>Delete item again</p></li></ol></div>
<aside class="notes">LIVE: Show application</aside></section><section id="geb-spec-basics"><h2>Geb Spec Basics</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">import</span> <span class="include">geb.spock.GebSpec</span>

<span class="annotation">@Stepwise</span> <span class="comment">// Ensures the tests are run sequentially</span>
<span class="type">class</span> <span class="class">TodoSpec</span> <span class="directive">extends</span> GebSpec {

    <span class="comment">// Spock specs here</span>
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>Spock, but JUnit is also available
GebReportingSpec</p></div></aside></section><section id="geb-spec-1"><h2>Geb Spec (1)</h2><div class="paragraph"><p>The naive inmaintainable way!</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Go to index page</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Go to index url</span><span class="delimiter">'</span></span>
    go <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span>

    <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">Verify we are there</span><span class="delimiter">'</span></span>
    title == <span class="string"><span class="delimiter">&quot;</span><span class="content">Todo List</span><span class="delimiter">&quot;</span></span>
}</code></pre></div></div></section><section id="geb-spec-2"><h2>Geb Spec (2)</h2><div class="paragraph"><p>The naive inmaintainable way!</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Create new todo</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Input text and submit</span><span class="delimiter">'</span></span>
    <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#new-todo</span><span class="delimiter">&quot;</span></span>) &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Do this</span><span class="delimiter">&quot;</span></span>
    <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#create-btn</span><span class="delimiter">&quot;</span></span>).click()

    <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">Verify new item present in list</span><span class="delimiter">'</span></span>
    waitFor { <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#count</span><span class="delimiter">&quot;</span></span>).text() == <span class="string"><span class="delimiter">'</span><span class="content">4</span><span class="delimiter">'</span></span>}
    <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">li.todo-item</span><span class="delimiter">'</span></span>).any{ <span class="local-variable">it</span>.text().contains <span class="string"><span class="delimiter">'</span><span class="content">Do this</span><span class="delimiter">'</span></span> }

    <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">Verify input field empty</span><span class="delimiter">'</span></span>
    !<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#new-todo</span><span class="delimiter">&quot;</span></span>).text()
}</code></pre></div></div></section><section id="geb-spec-3"><h2>Geb Spec (3)</h2><div class="paragraph"><p>The naive inmaintainable way!</p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Delete todo item</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Click delete and accept</span><span class="delimiter">'</span></span>
    withConfirm {
        <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">button</span><span class="delimiter">'</span></span>, <span class="integer">4</span>).click()
    }

    <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">Verify item deleted</span><span class="delimiter">'</span></span>
    waitFor { <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#count</span><span class="delimiter">&quot;</span></span>).text() == <span class="string"><span class="delimiter">'</span><span class="content">3</span><span class="delimiter">'</span></span>}
    <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">li.todo-item</span><span class="delimiter">'</span></span>).every{ !( <span class="local-variable">it</span>.text().contains(<span class="string"><span class="delimiter">'</span><span class="content">Do this</span><span class="delimiter">'</span></span>)) }
}</code></pre></div></div></section></section>
<section><section id="geb-spec-the-better-way"><h2>Geb Spec - The Better Way</h2><div class="paragraph"><p>If we make a few scenarios, there will be</p></div><div class="ulist"><ul><li><p>Much duplication</p></li><li><p>Many places to correct if we change the layout / DOM</p></li></ul></div></section><section id="solution"><h2>Solution</h2><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Use <em>pages</em> and <em>modules</em></td></tr></table></div></section><section id="page-objects"><h2>Page Objects</h2><div class="paragraph"><p><strong>Describes a web page</strong></p></div>
<div class="ulist"><ul><li><p>Url</p></li><li><p>How to check if we are at the correct place</p></li><li><p>Content we wish to interact with</p><div class="ulist"><ul><li><p>.. and how it is found</p></li></ul></div></li><li><p>Helper methods</p></li></ul></div>
<aside class="notes">In a phrase: Domain Modelling<br />
trusted principles; encapsulation and reuse.</aside></section><section id="page-objects-2"><h2>Page Objects</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">package</span> net.grydeske.greach.pages

<span class="keyword">import</span> <span class="include">geb.Page</span>

<span class="type">class</span> <span class="class">AboutPage</span> <span class="directive">extends</span> Page {

    <span class="directive">static</span> url = <span class="string"><span class="delimiter">&quot;</span><span class="content">/about</span><span class="delimiter">&quot;</span></span>

    <span class="directive">static</span> at = {
        title == <span class="string"><span class="delimiter">&quot;</span><span class="content">About</span><span class="delimiter">&quot;</span></span>
    }

    <span class="directive">static</span> content = {
        header { <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">h1</span><span class="delimiter">'</span></span>, <span class="integer">0</span>) }
    }
}</code></pre></div></div>
<aside class="notes">url<br />
at must return true <br />
Fail fast<br />
content<br />
geb keeps track on current page</aside></section><section id="content-closure"><h2>Content Closure</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="directive">static</span> content = {
    info(<span class="key">required</span>: <span class="predefined-constant">false</span>) { <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div.info</span><span class="delimiter">&quot;</span></span>) }
    message(<span class="key">wait</span>: <span class="predefined-constant">false</span>) { <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div.message</span><span class="delimiter">&quot;</span></span>) }
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>Optional content</p></div>
<div class="paragraph"><p>Fails if not htere OW.</p></div>
<div class="paragraph"><p>Wait for dynamic content</p></div></aside></section><section id="modules"><h2>Modules</h2><div class="paragraph"><p><strong>Describes repeated content</strong></p></div>
<div class="ulist"><ul><li><p>Across pages</p></li><li><p>Repeated content within the same page</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Reused content fragments</p></div>
<div class="paragraph"><p>Encapsulation and reuse</p></div></aside></section><section id="modules-across-pages"><h2>Modules Across Pages</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">package</span> net.grydeske.greach.modules

<span class="keyword">import</span> <span class="include">geb.Module</span>

<span class="type">class</span> <span class="class">MenubarModule</span>  <span class="directive">extends</span> Module {

    <span class="directive">static</span> base = { <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">nav.navbar</span><span class="delimiter">&quot;</span></span>) }

    <span class="directive">static</span> content = {
        home { <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">text</span>: <span class="string"><span class="delimiter">'</span><span class="content">Todo List</span><span class="delimiter">'</span></span>) }
        about { <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">text</span>: <span class="string"><span class="delimiter">'</span><span class="content">About</span><span class="delimiter">'</span></span>) }
    }

}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>Notice it locates its own base from where to extract values</p></div></aside></section><section id="modules-for-repeated-content"><h2>Modules For Repeated Content</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">package</span> net.grydeske.greach.modules

<span class="keyword">import</span> <span class="include">geb.Module</span>

<span class="type">class</span> <span class="class">TodoItemModule</span>  <span class="directive">extends</span> Module {

    <span class="directive">static</span> content = {
        checkbox { <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">input</span><span class="delimiter">'</span></span>, <span class="key">type</span>: <span class="string"><span class="delimiter">'</span><span class="content">checkbox</span><span class="delimiter">'</span></span>) }
        label { <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">label</span><span class="delimiter">'</span></span>).text() }
        deleteBtn { <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">button</span><span class="delimiter">'</span></span>) }
    }

}</code></pre></div></div></section><section id="using-modules"><h2>Using Modules</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="directive">static</span> content = {
  menubar { module MenubarModule }
  todos(<span class="key">required</span>: <span class="predefined-constant">false</span>) {
      <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">li.todo-item</span><span class="delimiter">'</span></span>).moduleList(TodoItemModule)
  }
}</code></pre></div></div></section><section id="geb-spec-structured"><h2>Geb Spec - structured</h2><div class="paragraph"><p>Lets try to restructure the ugly spec from before</p></div></section><section id="geb-spec-structured-1"><h2>Geb Spec - structured (1)</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Go to index page</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Go to index url</span><span class="delimiter">'</span></span>
    to IndexPage

    <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">Verify 3 items present</span><span class="delimiter">'</span></span>
    at IndexPage
    countValue == <span class="string"><span class="delimiter">'</span><span class="content">3</span><span class="delimiter">'</span></span>
}</code></pre></div></div></section><section id="geb-spec-structured-2"><h2>Geb Spec - structured (2)</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Create new todo</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Input text and submit</span><span class="delimiter">'</span></span>
    todoInput = <span class="string"><span class="delimiter">&quot;</span><span class="content">Do this</span><span class="delimiter">&quot;</span></span>
    todoSubmit.click()

    <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">Verify new item present in list</span><span class="delimiter">'</span></span>
    waitFor { countValue == <span class="string"><span class="delimiter">'</span><span class="content">4</span><span class="delimiter">'</span></span>}
    todos.any{ <span class="local-variable">it</span>.label == <span class="string"><span class="delimiter">'</span><span class="content">Do this</span><span class="delimiter">'</span></span> }

    <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">Verify input field empty</span><span class="delimiter">'</span></span>
    !todoInput.text()
}</code></pre></div></div></section><section id="geb-spec-structured-3"><h2>Geb Spec - structured (3)</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Delete todo item</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Click delete and accept</span><span class="delimiter">'</span></span>
    withConfirm {
        todos.find{ <span class="local-variable">it</span>.label == <span class="string"><span class="delimiter">'</span><span class="content">Do this</span><span class="delimiter">'</span></span> }.deleteBtn.click()
    }

    <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">Verify item deleted</span><span class="delimiter">'</span></span>
    waitFor {countValue == <span class="string"><span class="delimiter">'</span><span class="content">3</span><span class="delimiter">'</span></span>}
    todos.every{ <span class="local-variable">it</span>.label != <span class="string"><span class="delimiter">'</span><span class="content">Do this</span><span class="delimiter">'</span></span> }
}</code></pre></div></div></section><section id="standalone-revisited"><h2>Standalone Revisited</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">class</span> <span class="class">DuckDuckGoPage</span> <span class="directive">extends</span> geb.Page {

    <span class="directive">static</span> url = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://duckduckgo.com</span><span class="delimiter">&quot;</span></span>

    <span class="directive">static</span> at = { title ==~ <span class="regexp"><span class="delimiter">/</span><span class="content">DuckDuckGo</span><span class="delimiter">/</span></span> }

    <span class="directive">static</span> content = {
        inputField{ <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">input</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">q</span><span class="delimiter">'</span></span>) }
    }

    <span class="keyword">def</span> <span class="function">submit</span>() {
        inputField &lt;&lt; Keys.ENTER
    }
}</code></pre></div></div></section><section id="standalone-revisited-2"><h2>Standalone Revisited</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">class</span> <span class="class">DuckDuckGoResultPage</span> <span class="directive">extends</span> geb.Page {

        <span class="directive">static</span> url = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://duckduckgo.com</span><span class="delimiter">&quot;</span></span>

        <span class="directive">static</span> at = { <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#links</span><span class="delimiter">&quot;</span></span>).displayed }

        <span class="directive">static</span> content = {
                links{ <span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">h2.result__title</span><span class="delimiter">&quot;</span></span>) }
        }

        <span class="keyword">def</span> <span class="function">clickLink</span>(<span class="type">int</span> linkNumber) {
                links[linkNumber].click()
        }
}</code></pre></div></div></section><section id="standalone-revisited-3"><h2>Standalone Revisited</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">class</span> <span class="class">GreachPage</span> <span class="directive">extends</span> geb.Page {
        <span class="directive">static</span> at = { title.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">Greach</span><span class="delimiter">&quot;</span></span>) }
}</code></pre></div></div></section><section id="standalone-revisited-4"><h2>Standalone Revisited</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">browser.with {
    to DuckDuckGoPage

    inputField &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Greach Conference</span><span class="delimiter">&quot;</span></span>
    submit()

    waitFor(<span class="integer">10</span>, <span class="float">0.5</span>) {
        at DuckDuckGoResultPage
    }

    sleep(<span class="integer">3000</span>) <span class="comment">// For demo reasons</span>

    clickLink(<span class="integer">0</span>)

    waitFor {
        at GreachPage
    }
}</code></pre></div></div>
<aside class="notes">Also pages for DuckDuckGoResultPage and GR8Conf India</aside></section></section>
<section><section id="javascript"><h2>Javascript</h2><div class="paragraph"><p>In case you need to interact using javascript</p></div></section><section id="executing-javascript"><h2>Executing Javascript</h2><div class="paragraph"><p>Clicking a button that is hidden will create a <code>ElementNotVisibleException</code></p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="html language-html"><span class="tag">&lt;fieldset</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">well</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">display</span>: <span class="value">none</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;a</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/list</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">btn</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>List<span class="tag">&lt;/a&gt;</span>
<span class="tag">&lt;/fieldset&gt;</span></code></pre></div></div></section><section id="executing-javascript-2"><h2>Executing Javascript</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">JavascriptExecutor executor = (JavascriptExecutor) driver
executor.executeScript(<span class="string"><span class="delimiter">'</span><span class="content">jQuery(&quot;.well&quot;).show();</span><span class="delimiter">'</span></span>)</code></pre></div></div></section><section id="wrapping-javascript"><h2>Wrapping Javascript</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="keyword">def</span> <span class="function">js</span>( <span class="predefined-type">String</span> script ){
    (driver <span class="keyword">as</span> JavascriptExecutor).executeScript( script )
}</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">js(<span class="string"><span class="delimiter">'</span><span class="content">jQuery(&quot;.well&quot;).show();</span><span class="delimiter">'</span></span>)</code></pre></div></div></section><section id="jquery-shorthand"><h2>Jquery shorthand</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">div#a</span><span class="delimiter">&quot;</span></span>).jquery.mouseover()
<span class="error">$</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#a</span><span class="delimiter">&quot;</span></span>).jquery.trigger(<span class="string"><span class="delimiter">'</span><span class="content">mouseover</span><span class="delimiter">'</span></span>)</code></pre></div></div>
<aside class="notes">Groovy code - not Javascript<br />
Dont abuse!<br />
developed to make triggering mouse related events easier.<br />
Use interact if possible or directly JQuery</aside></section><section id="waiting-and-pausing"><h2>Waiting and Pausing</h2></section><section id="waiting"><h2>Waiting</h2><div class="listingblock"><div class="title">GebConfig.groovy</div><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">waiting {
    timeout = <span class="integer">10</span>
    retryInterval = <span class="float">0.5</span>
}

baseNavigatorWaiting = <span class="predefined-constant">true</span>
atCheckWaiting = <span class="predefined-constant">true</span></code></pre></div></div></section><section id="using-waiting"><h2>Using Waiting</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="html language-html"><span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">fade-me-in</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">style</span>=<span class="string"><span class="delimiter">&quot;</span><span class="key">display</span>: <span class="value">none</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  Hi - are yo waiting for me?
<span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;script&gt;</span>
<span class="inline">  <span class="predefined">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">div.fade-me-in</span><span class="delimiter">'</span></span>).delay(<span class="integer">3000</span>).slideDown();</span>
<span class="tag">&lt;/script&gt;</span></code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="directive">static</span> content = {
    fadeInMessage{ <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">div.fade-me-in</span><span class="delimiter">'</span></span>) }
}</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="key">then</span>:
waitFor {
    fadeInMessage.text() == <span class="string"><span class="delimiter">'</span><span class="content">Hi - are yo waiting for me?</span><span class="delimiter">'</span></span>
}</code></pre></div></div>
<aside class="notes">DEMO - Fil: ManyAttendeesSpec</aside></section><section id="pausing-geb"><h2>Pausing Geb</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="directive">private</span> <span class="type">void</span> pause() {
    js.exec <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">(function() {
      window.__gebPaused = true;
      var div = document.createElement(&quot;div&quot;);
      div.setAttribute('style',
        &quot;position: absolute; top:0px;right: 0px;z-index: 3000;</span><span class="char">\\</span><span class="content">
        padding: 10px; background-color: red;&quot;);
      var button = document.createElement(&quot;button&quot;);
      button.innerHTML = &quot;Unpause Geb&quot;;
      button.onclick = function() {
          window.__gebPaused = false;
      }
      div.appendChild(button);
      document.getElementsByTagName(&quot;body&quot;)[0].appendChild(div);
    })();</span><span class="delimiter">&quot;&quot;&quot;</span></span>
    waitFor(<span class="integer">300</span>) { !js.__gebPaused }
}</code></pre></div></div></section><section id="pausing-geb-2"><h2>Pausing Geb</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Demoing pause</span><span class="delimiter">'</span></span>
pause() <span class="comment">// Pause Geb until button pressed</span></code></pre></div></div></section><section id="pausing-geb-3"><h2>Pausing Geb</h2><div class="imageblock" style=""><img src="./images/pause-geb.png" alt="pause geb" /></div>
<aside class="notes">LIVE DEMO: PauseFunctionalSpec???</aside></section><section id="reporting"><h2>Reporting</h2></section><section id="test-reports"><h2>Test reports</h2></section><section id="screenshots"><h2>Screenshots</h2><div class="paragraph"><p>Screenshots and HTML from end of each test:</p></div>
<div class="paragraph"><p>Extend from <code>GebReportingSpec</code></p></div>
<div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy"><span class="type">class</span> <span class="class">AttendeeFunctionalSpec</span> <span class="directive">extends</span> GebReportingSpec</code></pre></div></div>
<div class="listingblock"><div class="title">GebConfig.groovy</div><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">reportsDir = <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">build/geb-reports</span><span class="delimiter">&quot;</span></span>)
reportOnTestFailureOnly = <span class="predefined-constant">true</span></code></pre></div></div>
<aside class="notes">DEMO: Class</aside></section><section id="ad-hoc-screenshots"><h2>Ad-hoc Screenshots</h2><div class="listingblock"><div class="content"><pre class="CodeRay"><code class="groovy language-groovy">report <span class="string"><span class="delimiter">&quot;</span><span class="content">When-form-is-just-filled</span><span class="delimiter">&quot;</span></span></code></pre></div></div>
<div class="ulist"><ul><li><p>Saves a report in reportsDir</p></li><li><p>Numbered in increasing order</p></li></ul></div></section></section>
<section><section id="conclusion"><h2>Conclusion</h2></section><section id="spock-resources"><h2>Spock Resources</h2><div class="ulist"><ul><li><p><a href="http://spockframework.github.io/spock/docs" class="bare">http://spockframework.github.io/spock/docs</a></p></li><li><p><a href="http://spockframework.org/" class="bare">http://spockframework.org/</a></p></li><li><p><a href="https://github.com/spockframework" class="bare">https://github.com/spockframework</a></p></li><li><p><a href="https://github.com/robfletcher/spock-katas" class="bare">https://github.com/robfletcher/spock-katas</a></p></li></ul></div></section><section id="geb-resources"><h2>Geb Resources</h2><div class="ulist"><ul><li><p><a href="http://gebish.org" class="bare">http://gebish.org</a></p></li><li><p><a href="https://www.youtube.com/watch?v=xdUgQiAR0w8&amp;index=18&amp;list=PLXcHRe1w86EfRwsy9G6gr7WQrM3tUl1lW">Video: Geb best practices - Marcin Erdmann</a> - <a href="https://www.slideshare.net/MarcinErdmann/geb-best-practices?">slides</a></p></li><li><p><a href="https://groups.google.com/forum/#!forum/geb-user" class="bare">https://groups.google.com/forum/#!forum/geb-user</a></p></li><li><p><a href="https://github.com/geb" class="bare">https://github.com/geb</a></p></li><li><p><a href="https://gist.github.com/melix/9619800" class="bare">https://gist.github.com/melix/9619800</a></p></li><li><p><a href="https://github.com/tomaslin/grails-test-recipes" class="bare">https://github.com/tomaslin/grails-test-recipes</a></p></li><li><p><a href="https://fbflex.wordpress.com/2010/08/25/geb-and-grails-tips-tricks-and-gotchas/" class="bare">https://fbflex.wordpress.com/2010/08/25/geb-and-grails-tips-tricks-and-gotchas/</a></p></li><li><p><a href="https://github.com/JacobAae/gr8conf-in-2016-geb-for-grails" class="bare">https://github.com/JacobAae/gr8conf-in-2016-geb-for-grails</a></p></li></ul></div></section></section>
<section id="questions"><h2>Questions</h2><aside class="notes"><div class="paragraph"><p>Done</p></div></aside></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: true,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: true,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'simple',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1200,
  height: 800,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});</script><div id="presentation-logo">
	<img src="images/black-logo.png" class="ribbon"/>
</div>
<div id="conference-logo">
	<img src="images/gr8conf-black.png" class="ribbon"/>
</div></body></html>